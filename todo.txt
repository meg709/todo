# --- Load PublicUser Registry Hive ---
reg load "HKU\TempPublicUser" "C:\Users\PublicUser\NTUSER.DAT"

$edgeKeyPath = "Registry::HKEY_USERS\TempPublicUser\Software\Policies\Microsoft\Edge"

# Create the Edge policies key if missing
New-Item -Path $edgeKeyPath -Force | Out-Null

# Allow only the two NYP websites (MultiString)
New-ItemProperty -Path $edgeKeyPath -Name "URLAllowlist" -Value @(
    "https://library.nyp.edu.sg/*",
    "https://www.nyp.edu.sg/*"
) -PropertyType MultiString -Force

# Block all other sites (MultiString)
New-ItemProperty -Path $edgeKeyPath -Name "URLBlocklist" -Value @("*") -PropertyType MultiString -Force

# OPTIONAL: Block downloads completely (DWord)
New-ItemProperty -Path $edgeKeyPath -Name "DownloadRestrictions" -Value 3 -PropertyType DWord -Force

# OPTIONAL: Disable InPrivate mode (DWord) — If needed
New-ItemProperty -Path $edgeKeyPath -Name "InPrivateModeAvailability" -Value 1 -PropertyType DWord -Force

# Display what is configured
Write-Host "`n--- CURRENT PUBLICUSER EDGE POLICY VALUES ---"
Get-ItemProperty -Path $edgeKeyPath

# Unload the hive (IMPORTANT!)
reg unload "HKU\TempPublicUser"

Write-Host "`nDONE → Log into PublicUser and launch Edge."
Write-Host "Only the 2 NYP websites should work now."
