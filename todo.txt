$zip="$env:TEMP\MicrosoftEdgePolicyTemplates.zip"; Invoke-WebRequest -Uri "https://msedge.sf.microsoft.com/edge/update/stable/MicrosoftEdgePolicyTemplates.zip" -OutFile $zip -ErrorAction SilentlyContinue; if (Test-Path $zip) { Expand-Archive $zip "$env:TEMP\admx_temp" -Force -ErrorAction SilentlyContinue; $admxSource="$env:TEMP\admx_temp\MicrosoftEdgePolicyTemplates\windows\admx"; $admlSource="$env:TEMP\admx_temp\MicrosoftEdgePolicyTemplates\windows\adml\en-US"; if (Test-Path $admxSource) { Copy-Item "$admxSource\*" "C:\Windows\PolicyDefinitions\" -Recurse -Force -ErrorAction SilentlyContinue; if (Test-Path $admlSource) { Copy-Item "$admlSource\*" "C:\Windows\PolicyDefinitions\en-US\" -Recurse -Force -ErrorAction SilentlyContinue } }; Remove-Item "$env:TEMP\admx_temp" -Recurse -Force -ErrorAction SilentlyContinue; Remove-Item $zip -Force }; gpupdate /force; if (Test-Path "C:\Windows\PolicyDefinitions\msedge.admx") { Write-Host "ADMX imported successfully â€“ policies stick now. Run the policy line next, then reboot." } else { Write-Host "Failed: Manual download from https://www.microsoft.com/en-us/edge/business/download (Stable > Windows 64-bit > Download Windows Policy ZIP), extract MicrosoftEdgePolicyTemplates\windows\admx/* to C:\Windows\PolicyDefinitions\ and en-US to en-US subfolder, then gpupdate /force." }
